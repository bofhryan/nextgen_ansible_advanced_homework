---
# tasks file for lb-tier
- name: install haproxy
  yum:
    name: haproxy
    state: latest

- name: copy haproxy config
  template:
    src: templates/haproxy.cfg.j2
    dest: /etc/haproxy/haproxy.cfg
    mode: 0644
  notify: restart haproxy

- name: cat config output
  shell: cat /etc/haproxy/haproxy.cfg
  register: ha_config

-name: debug output
  debug:
    msg: "{{ ha_config }}"

- name: start and enable haproxy at reboot
  service:
    name: haproxy
    state: started
